import{lpFetchAPI}from"../utils";import API from"../api";function widgetRestAPI(){const e=document.querySelectorAll(".learnpress-widget-wrapper");if(!e.length)return;e.forEach((e=>{e.classList.contains("learnpress-widget-wrapper__restapi")&&(e=>{const t=e.dataset.widget?JSON.parse(e.dataset.widget):"",s=API.frontend.apiWidgets,a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,params_url:lpGlobalSettings.lpArchiveSkeleton})};0!==lpGlobalSettings.user_id&&(a.headers["X-WP-Nonce"]=lpGlobalSettings.nonce),lpFetchAPI(s,a,{before:()=>{},success:t=>{const{data:s,status:a,message:n}=t;s&&"success"===a?e.insertAdjacentHTML("afterbegin",s):n&&e.insertAdjacentHTML("afterbegin",`<div class="lp-ajax-message error" style="display:block">${n}</div>`)},error:e=>{},completed:()=>{delete e.dataset.widget,e.querySelector(".lp-skeleton-animation").remove()}})})(e)}))}document.addEventListener("DOMContentLoaded",(function(e){widgetRestAPI()}));