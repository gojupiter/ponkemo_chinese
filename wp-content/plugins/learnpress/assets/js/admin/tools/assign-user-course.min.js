import TomSelect from"tom-select";import{lpFetchAPI}from"../../utils.js";import Api from"../../api.js";export default function assignUserCourse(){let e;const t=(e,t,o)=>{const s=Api.admin.apiSearchCourses,n={headers:{"Content-Type":"application/json","X-WP-Nonce":lpGlobalSettings.nonce},method:"POST",body:JSON.stringify({c_search:e})};lpFetchAPI(s,n,{success:e=>{const s=e.data.map((e=>({value:e.ID,text:e.post_title+`(#${e.ID})`})));"function"==typeof t&&("setupOptions"===t.name?o.setupOptions(s):t(s))}})};document.addEventListener("DOMContentLoaded",(()=>{e=document.querySelector("#lp-assign-user-course-form"),e&&(e.addEventListener("submit",(e=>{console.log("submit"),e.preventDefault();const t=new FormData(e.target),o=Object.fromEntries(Array.from(t.keys(),(e=>{const o=t.getAll(e);return[e,o.length>1?o:o.pop()]}))),s={headers:{"Content-Type":"application/json","X-WP-Nonce":lpGlobalSettings.nonce},method:"POST",body:JSON.stringify(o)};lpFetchAPI(Api.admin.apiAssignUserCourse,s,{success:e=>{console.log(e)}})})),(()=>{const o=e.querySelector("[name=course_ids]");if(!o)return;const s=new TomSelect(o,{maxItems:5,options:[],load(e,o){t(e,o)}});t("course",s.setupOptions,s)})())}))}